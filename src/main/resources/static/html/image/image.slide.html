<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Full image slide</title>
<link rel="icon" type="image/png" href="/img/favicon/flay_2.png"/>
<link rel="stylesheet" href="/webjars/fontawesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/webjars/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="/webjars/jquery-ui/jquery-ui.min.css"/>
<link rel="stylesheet" href="/css/crazy.common.css">
<style type="text/css">
#imageWrap {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-repeat: no-repeat;
    background-position: center;
    background-color: #000;
    background-size: contain;
    transition: .3s;
}

#controlBox {
	opacity: 0;
}
#controlBox:hover {
	opacity: 1;
}
</style>
</head>
<body>

	<div id="imageWrap"></div>

	<div id="controlBox" class="bottom-right">
		<div class="input-group input-group-sm">
			<div class="input-group-prepend">
				<span class="input-group-text border-dark bg-dark text-light" id="imgTitle"></span>
			</div>
			<input class="form-control border-dark bg-dark text-light text-right" id="currNo" style="width: 50px;" value="0" title="input Image Index" autocomplete="off">
			<div class="input-group-append">
				<span class="input-group-text border-dark bg-dark text-light pl-0">
					/&nbsp;<sub id="totalNo"></sub>
				</span>
				<a href="/" class="btn btn-dark"><i class="fa fa-home"></i></a>
			</div>
		</div>
	</div>

</body>
<script type="text/javascript" src="/webjars/jquery/jquery.min.js"></script>
<script type="text/javascript" src="/webjars/popper.js/umd/popper.js"></script>
<script type="text/javascript" src="/webjars/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/webjars/jquery-ui/jquery-ui.min.js"></script>
<script type="text/javascript" src="/js/crazy.common.js"></script>
<script type="text/javascript" src="/js/crazy.jquery.js"></script>
<script type="text/javascript" src="/js/flay.rest.service.js"></script>
<script type="text/javascript" src="/js/flay.utils.js"></script>
<script type="text/javascript">
var slide = {
		totalCount: 0,
		currIndex: 0,
		bgInterval: null,
		bgSize: ['contain', 'cover', 'auto'],
		bgSizeIndex: 0,
		$image: $("#imageWrap"),
		init: function() {
			Rest.Image.size(function(count) {
				slide.totalCount = count;
				$("#totalNo").html(count);
			});
			// nav event
			slide.$image.navEvent(function(signal, e) {
				// console.log('e.keyCode', signal);
				switch (signal) {
				case 32: // key space
					slide.random();
					break;
				case 37: // key left
				case 1: // mousewheel up
					slide.prev();
					break;
				case 39: // right
				case -1: // mousewheel down
					slide.next();
					break;
				case 1002:
					slide.$image.css({
						backgroundSize: slide.bgSize[++slide.bgSizeIndex % 3]
					});
					break;
				}
			});
			$("#currNo").on("keyup", function(e) {
				if (e.keyCode === 13) {
					slide.currIndex = parseInt($(this).val());
					slide.view();
				}
			});
			$("#controlBox").hover(function() {
				Rest.Image.get(slide.currIndex - 1, function(imgInfo) {
					console.log(imgInfo);
					$("#imgTitle").html(imgInfo.name);
				});
			}, function() {});
			// start
			slide.random();
		},
		random: function() {
			slide.currIndex = Random.getInteger(0, slide.totalCount);
			slide.view();
		},
		prev: function() {
			slide.currIndex -= 2;
			slide.view();
		},
		next: function() {
			slide.view();
		},
		view: function() {
			function setImage() {
				if (slide.currIndex >= slide.totalCount) {
					slide.currIndex = 0;
				} else if (slide.currIndex < 0) {
					slide.currIndex = slide.totalCount - 1;
				}
				// console.log("setImage", slide.currIndex);
				$("#currNo").val(slide.currIndex);
				slide.$image.css({
					backgroundImage: 'url(' + PATH + "/static/image/" + slide.currIndex++ + ')'
				});
			}
			clearInterval(slide.imageEngine);
			setImage();
			slide.imageEngine = setInterval(setImage, 10 * 1000);
		}
};
slide.init();
</script>
</html>