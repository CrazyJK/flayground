<meta charset="UTF-8">
<title>Note list</title>
<div>
	<table class="table table-hover">
		<thead>
			<tr>
				<th>No</th>
				<th>Id</th>
				<th>Title</th>
				<th>Content</th>
				<th>Created</th>
				<th>Modified</th>
				<th>Closed</th>
				<th>Position</th>
				<th>Size</th>
				<th>Status</th>
				<th>Minimized</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody id="noteList">
		</tbody>
	</table>
</div>
<script type="text/javascript">
restCall('/info/note/list', {}, function(list) {
	list.forEach(function(note, idx) {
		$("#noteList").append(
				$("<tr>").append(
						$("<td>").html(idx+1),
						$("<td>").html(note.id),
						$("<td>").html(note.title),
						$("<td>").html(note.content.replace(/(\n|\r\n)/g, '<br>')),
						$("<td>").html(new Date(note.created).format('yy/MM/dd hh:mm')),
						$("<td>").html(new Date(note.modified).format('yy/MM/dd hh:mm')),
						$("<td>").html(new Date(note.closed).format('yy/MM/dd hh:mm')),
						$("<td>").html("L: " + note.position.left + " T: " + note.position.top),
						$("<td>").html("W: " + note.size.width + " H: " + note.size.height),
						$("<td>").append(
								$("<div>", {class: 'custom-control custom-switch'}).append(
										$("<input>", {type: 'checkbox', class: 'custom-control-input', id: 'status'+note.id, checked: (note.status == 'N')}).on("change", function() {
											var val = $(this).is(":checked") ? 'N' : 'D';
											note.status = val;
											$(this).next().html(val);
											restCall('/info/note', {data: note, method: "PUT"}, function() {
												console.log('update note status');
											});
										}),
										$("<label>", {class: 'custom-control-label', for: 'status'+note.id}).html(note.status)
								)
						),
						$("<td>").append(
								$("<div>", {class: 'custom-control custom-switch'}).append(
										$("<input>", {type: 'checkbox', class: 'custom-control-input', id: 'mini'+note.id, checked: note.windowMinimized}).on("change", function() {
											var val = $(this).is(":checked");
											note.windowMinimized = val;
											$(this).next().html(val);
											restCall('/info/note', {data: note, method: "PUT"}, function() {
												console.log('update note windowMinimized');
											});
										}),
										$("<label>", {class: 'custom-control-label', for: 'mini'+note.id}).html(note.windowMinimized)
								)
						),
						$("<td>").append(
								$("<button>", {class: 'btn btn-sm btn-outline-danger'}).html('Delete').on("click", function() {
									var $thisNote = $(this).parent().parent();
									restCall('/info/note', {data: note, method: "DELETE"}, function() {
										console.log('delete note', $thisNote);
										$thisNote.remove();
									});
								}),
						)
				)
		);
	});
});
</script>