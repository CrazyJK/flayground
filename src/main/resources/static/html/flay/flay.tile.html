<style>
<!--
:root {
	--tile-width: 200px;
}
#tileWrap {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	width: 100%;
	height: 100%;
	text-align: center;
	margin-top: 1rem;
	padding: 1rem;
}
.tile {
	cursor: pointer;
	background: #000 url(/img/pattern/pattern-static.png);
	display: inline-block;
	width:  calc(var(--tile-width) + 7px);
	height: calc(var(--tile-width) * 2 * 0.6625);
	margin: 0;
	border: 1px solid #fff;
	transition: all 0.3s ease-in-out;
}
.tile > div.title {
	opacity: 0;
	transition: all 0.3s ease-in-out;
}
.tile:hover > div.title {
	opacity: 1;
	background-color: rgba(16, 51, 86, .5);; 
	box-shadow: 0 0 1px #103356;
	color: #fff;
	text-shadow: 1px 1px 1px #103356; 
}
-->
</style>
<div role="body">

	<div id="tileWrap"></div>

</div>
<script type="text/javascript">
var flayList;
var currIndex = 0;

Rest.Flay.list(function(list) {
	flayList = list;
	currIndex = Random.getInteger(0, flayList.length);
	displayTile();
	
	$("body").navEvent(function(signal) {
		switch(signal) {
		case -1: // mousewheel: down
		case 32: // key : space
			displayTile();
			break;
		}
	});
});

function displayTile() {
	var $tileWrap = $("#tileWrap").empty();
	var tileWrapHeight = $tileWrap.height() + 32;
	
	do {
		if (currIndex >= flayList.length) {
			currIndex = 0;
		}
		
		var flay = flayList[currIndex++];
		if (flay.video.rank > 0) {
			continue;
		}
		
		var $tile = $("<div>", {class: 'tile'}).data('flay', flay).on('click', function() {
			var _flay = $(this).data('flay');
			Rest.Flay.play(_flay, function() {
				View.flay(_flay.opus);
			});
		}).append(
				$("<div>", {class: 'title nowrap'}).html(flay.title)
		);
		
		$tile.appendTo($tileWrap);
		
		var bottom = $tile.position().top + $tile.height();
		if (tileWrapHeight < bottom) {
			$tile.remove();
			--currIndex;
			break;
		}

		$tile.css({
			background: 'url(/static/cover/' + flay.opus + ') right top / cover no-repeat',
		});

	} while(true);
	
}
</script>
